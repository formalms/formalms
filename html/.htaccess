Options -Indexes
#no need to follow symbolic links in standard configuration
#Options +FollowSymLinks
DirectoryIndex index.php index.html index.htm

<Files favicon.ico>
        ErrorDocument 404 "The requested file favicon.ico was not found."
</Files>

<IfModule mod_rewrite.c>
        RewriteEngine on

        # hide directories that starts with a . (dot)
        RewriteRule "(^|/)\.(?!htaccess)" - [F]

        # Redirect to the www version of the site
        #RewriteCond %{HTTP_HOST} !^www\. [NC]
        #RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)/$ /$1 [R=301,L]

        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)/upgrade?$ /$1/upgrader [R,L]
        RewriteRule ^(.*)/install?$ /$1/installer [R,L]
        RewriteRule ^upgrade?$ /upgrader [R,L]
        RewriteRule ^install?$ /installer [R,L]

        RewriteRule ^(.*)/upgrade/?$ /$1/upgrader [R,L]
        RewriteRule ^(.*)/install/?$ /$1/installer [R,L]
        RewriteRule ^upgrade/?$ /upgrader [R,L]
        RewriteRule ^install/?$ /installer [R,L]


        RewriteRule ^(.*)/installer?$ /$1/index.php?r=adm/install/show
        RewriteRule ^(.*)/upgrader?$ /$1/index.php?r=adm/install/show
        RewriteRule ^installer?$ /index.php?r=adm/install/show&$1 [L,QSA]
        RewriteRule ^upgrader?$ /index.php?r=adm/install/show&$1 [L,QSA]

        RewriteRule ^(.*)/status?$ /$1/status.php
        RewriteRule ^status/([a-zA-Z-]*)$ /status.php?msg=$1

        ErrorDocument 404 /status.php?msg=found
        
</IfModule>

<FilesMatch "\.(htpasswd|ini|php|fla|psd|log|sh)$">
        Order Allow,Deny
        Deny from all
</FilesMatch>

<FilesMatch "(composer\.(json|lock))$">
        Order Allow,Deny
        Deny from all
</FilesMatch>

<FilesMatch "((?i:readme)\.(?i:txt|md)|(?i:README))$">
        Order Allow,Deny
        Deny from all
</FilesMatch>

<FilesMatch "(index\.php|status\.php|ajax\..*\.php|paypal\.php|cron\.php|tasks\.php|tinymce\.gzip\.php|index_tiny\.php|scormXmlTree\.php|soaplms\.php|scorm_page_body\.php|keep_alive\.php|text\.php|users\.php|write\.php|check\.php)$">
        Order Allow,Deny
        Allow from all
</FilesMatch>
